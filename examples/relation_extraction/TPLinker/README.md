
# TPLink PyTorch re-implementation

### Overview

+ 论文名: TPLinker: Single-stage Joint Extraction of Entities and Relations Through Token Pair Linking
+ 论文地址: https://arxiv.org/pdf/2010.13415.pdf
+ 官方代码库: https://github.com/131250208/TPlinker-joint-extraction

### Experiments

本实验的代码主要是参考官方代码, 按照我之前的框架重构完成, 
本实验和原代码基本保持一致, 删除了 loss 权重变化的代码 (不知道其设计思路是什么), 采用了余弦退火的 lr_scheduler 策略。

数据集的使用和 **CasRel** 中保持一致, 实验结果如下:

```text
                     precision    recall  f1-score   support

                主演     0.8162    0.8812    0.8474      5411
                作者     0.8469    0.8385    0.8427      3709
                歌手     0.7421    0.7961    0.7681      2580
                导演     0.8292    0.8812    0.8544      2484
                父亲     0.6967    0.7224    0.7093      1819
             成立日期     0.8159    0.8323    0.8240      1741
                妻子     0.7436    0.7316    0.7376      1498
                丈夫     0.7420    0.7307    0.7363      1500
                国籍     0.7349    0.6845    0.7088      1442
                母亲     0.7114    0.7342    0.7226      1091
                作词     0.8214    0.8281    0.8247      1111
                作曲     0.7736    0.7832    0.7784      1047
             毕业院校     0.8338    0.8397    0.8368       992
             所属专辑     0.7671    0.7587    0.7629       916
               董事长     0.7449    0.7551    0.7500       878
                朝代     0.6323    0.5724    0.6008       760
                嘉宾     0.6373    0.7115    0.6724       662
             出品公司     0.6191    0.6384    0.6286       802
                编剧     0.7102    0.6897    0.6998       796
             上映时间     0.7129    0.7398    0.7261       688
                饰演     0.7427    0.7579    0.7502       636
                简称     0.7962    0.8100    0.8030       521
               主持人     0.7618    0.7663    0.7641       505
                配音     0.6016    0.6138    0.6076       492
                获奖     0.6005    0.5689    0.5843       399
               主题曲     0.7265    0.6792    0.7021       399
                校长     0.8430    0.8455    0.8443       343
             总部地点     0.5305    0.4688    0.4977       352
                主角     0.5871    0.5268    0.5553       224
               创始人     0.6178    0.6897    0.6517       232
                票房     0.7556    0.8095    0.7816       252
               制片人     0.6590    0.7010    0.6793       204
                 号     0.8947    0.9167    0.9056       204
                祖籍     0.8324    0.7842    0.8076       190

         micro avg     0.7644    0.7803    0.7723     36880
         macro avg     0.7318    0.7379    0.7343     36880
weighted macro avg     0.7635    0.7803    0.7714     36880
```

单个标签的统计结果如下: 

```text
                    precision    recall  f1-score   support

            head_1     0.7971    0.8615    0.8280     24092
            head_2     0.6793    0.7523    0.7140     12768
            tail_1     0.7910    0.8545    0.8216     23896
            tail_2     0.6746    0.7486    0.7097     12958
            entity     0.8372    0.9027    0.8687     55004

         micro avg     0.7885    0.8556    0.8207    128718
         macro avg     0.7558    0.8240    0.7884    128718
weighted macro avg     0.7891    0.8556    0.8210    128718
```
